<div class="col-md-8">
  <%= form_for document do |f| %>
    <%= render partial: "shared/form_errors", locals: { object: document } %>

    <%= f.text_field :title %>
    <%= f.text_area :summary, class: 'short-textarea' %>
    <%= f.text_area :body %>

    <div class="preview_button"></div>
    <div class="preview_container" style="display: none;"></div>

    <%= f.text_field :opened_date, placeholder: '2012-04-23' %>
    <%= f.text_field :closed_date, placeholder: '2013-10-19' %>
    <%= f.select :case_type, f.object.facet_options(:case_type) %>
    <%= f.select :case_state, f.object.facet_options(:case_state) %>
    <%= f.select :market_sector, f.object.facet_options(:market_sector) %>
    <%= f.select :outcome_type, f.object.facet_options(:outcome_type), include_blank: true %>

    <div class="actions">
      <button name="save" class="btn btn-success">Save as draft</button>
    </div>
  <% end %>
</div>

<%= render partial: "specialist_documents/attachments_form", locals: { document: document } %>

<%= content_for :document_ready do %>
  window.SpecialistDocument.addPreviewFeature({
    'url'             : '<%= preview_path_for_cma_case(document) %>',
    'insert_into'     : '.preview_container',
    'insert_button'   : '.preview_button',
    'render_to'       : '.preview .govspeak',
    'data_target'     : function() {
                          return {
                            'cma_case' : {
                              'body' : $('#cma_case_body').val()
                            }
                          };
                        }
  });
<% end -%>
