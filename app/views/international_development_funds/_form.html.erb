<div class="col-md-8">
  <%= form_for document do |f| %>
    <% if document.errors.any? %>
      <div class="errors error-list">
        <h2>Please fix the following errors found in the form</h2>
        <ul class="errors">
          <% document.errors.each do |field, errors| %>
            <% if errors %>
              <li><%= field.to_s.humanize %> <%= [*errors].join(' and ')  %></li>
            <% end %>
          <% end %>
        </ul>
      </div>
    <% end %>

    <%= f.text_field :title %>
    <%= f.text_area :summary, class: 'short-textarea' %>
    <%= f.text_area :body %>

    <div class="preview_button"></div>
    <div class="preview_container" style="display: none;"></div>

    <%= f.select :application_state, f.object.facet_options(:application_state) %>
    <%= f.select :location, f.object.facet_options(:location), {}, { class: 'select2', multiple: true, data: {placeholder: 'Select a location'} } %>
    <%= f.select :development_sector, f.object.facet_options(:development_sector), { label: 'Sector'}, { class: 'select2', multiple: true, data: {placeholder: 'Select a Sector'} } %>
    <%= f.select :eligible_entities, f.object.facet_options(:eligible_entities), { label: 'Eligible Organisations'}, { class: 'select2', multiple: true, data: {placeholder: 'Select an eligible organisation'} } %>
    <%= f.select :value_of_fund, f.object.facet_options(:value_of_fund), {}, { class: 'select2', multiple: true, data: {placeholder: 'Select a Value'} } %>


    <div class="actions">
      <button name="save" class="btn btn-success">Save as draft</button>
    </div>
  <% end %>
</div>

<div class="col-md-4">
  <%= render partial: 'shared/govspeak-help' %>

  <h2>Attachments</h2>

  <% if document.persisted? %>
    <%= link_to "Add attachment", [:new, document, :attachment] %>
  <% else %>
    <p>To add an attachment, please save the draft first.</p>
  <% end %>

  <ul class="attachments">
    <% document.attachments.each do |attachment| %>
      <li class="attachment">
        <span class="title"><%= attachment.title %></span>
        <span class="snippet"><%= attachment.snippet %></span>
        <%= link_to "edit", edit_international_development_fund_attachment_path(document, attachment) %>
      </li>
    <% end %>
  </ul>
</div>

<%= content_for :document_ready do %>
  window.SpecialistDocument.addPreviewFeature({
    'url'             : '<%= preview_path_for_international_development_fund(document) %>',
    'insert_into'     : '.preview_container',
    'insert_button'   : '.preview_button',
    'render_to'       : '.preview .govspeak',
    'data_target'     : function() {
                          return {
                            'international_development_fund' : {
                              'body' : $('#international_development_fund_body').val()
                            }
                          };
                        }
  });
<% end -%>
